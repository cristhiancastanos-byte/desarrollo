<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<h:head>
    <title>Administrador dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
    <style>
        :root{--sidebar:#262b33;--text:#f5f6f7;--accent1:#e3a56b;--accent2:#b3823a;}
        *{box-sizing:border-box}
        body{margin:0;background:#15181c;color:var(--text);font-family:Poppins,Arial,sans-serif}
        .wrap{padding:14px}
        .shell{background:#101215;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.35);overflow:hidden;min-height:70vh}

        .header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;background:linear-gradient(90deg,var(--accent1),var(--accent2));}
        .leftTitle{display:flex;align-items:center;gap:10px;font-weight:700;cursor:pointer}
        .pfp{width:38px;height:38px;border-radius:999px;background:rgba(255,255,255,.2);display:grid;place-items:center;font-size:20px}
        .leftTitle span{user-select:none}
        .logout{display:flex;align-items:center;gap:8px;cursor:pointer;color:#fff;text-decoration:none}
        .logout svg{width:26px;height:26px;filter:drop-shadow(0 2px 0 rgba(0,0,0,.3))}

        .drawer{position:fixed;top:0;left:0;height:100vh;width:280px;background:var(--sidebar);transform:translateX(-105%);transition:transform .22s ease;box-shadow:0 0 0 rgba(0,0,0,0);padding:16px;z-index:9998}
        .drawer.open{transform:translateX(0);box-shadow:12px 0 40px rgba(0,0,0,.35)}
        .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;z-index:9997}
        .overlay.show{display:block}
        .search{width:100%;border:none;border-radius:12px;background:#3a404a;color:#e8eaed;padding:12px 14px;outline:none;margin-bottom:12px}
        .menu{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:10px}
        .item{display:block;color:#eaecef}
        .item > a, .item > button, .sub-toggle{
            width:100%;display:flex;align-items:center;gap:12px;
            padding:12px;border-radius:12px;background:transparent;border:none;color:#eaecef;cursor:pointer;text-align:left
        }
        .item > a:hover, .item > button:hover, .sub-toggle:hover{background:#343b46}
        .item svg{width:24px;height:24px}

        .content{padding:28px;background:#ffffff;min-height:55vh}
        .hidden{display:none}

        .card{background:#151a21;border:1px solid #2a3039;border-radius:12px;padding:14px;margin-bottom:14px}
        .title{font-weight:700;margin:0 0 8px 0}
        .input{width:100%;background:#1e2430;border:1px solid #2c3440;border-radius:10px;color:#e8eaed;padding:10px 12px;outline:none}

        .form-wrapper{display:flex;justify-content:center}
        .form-card{
            width:860px;max-width:94vw;margin:14px auto 0 auto;
            background:#232832;border:1px solid #3a3f48;border-radius:12px;
            padding:24px 26px;box-shadow:0 16px 40px rgba(0,0,0,.25)
        }
        .form-card h2{margin:0 0 14px 0;font-weight:700}
        .grid-u{display:grid;grid-template-columns:repeat(3,minmax(200px,1fr));gap:14px}
        .grid-u > .span-3{grid-column:1/-1}

        .grid-p{display:grid;grid-template-columns:repeat(2,minmax(200px,1fr));gap:14px}
        .grid-p > .span-2{grid-column:1/-1}

        .lbl{display:block;font-size:13px;color:#c9ced8;margin-bottom:6px}
        .form-card .input{
            width:100%;background:#3a404a;border:1px solid #4a515c;color:#e8eaed;
            border-radius:12px;padding:12px 14px;outline:none
        }
        .hint{font-size:12px;color:#9aa3af;margin-top:6px}
        .hint.warn{color:#e07a7a}
        .item.has-sub.hover:hover .caret{transform:rotate(180deg)}

        .btn-prim{
            padding:12px 16px;border-radius:12px;border:none;background:#d0925b;
            color:#fff;cursor:pointer;font-weight:600;width:280px;max-width:60vw
        }
        .btn-prim:hover{filter:brightness(1.05)}
        .center-actions{display:flex;justify-content:center;margin-top:16px}

        .modal{
            position:fixed; inset:0; display:none;
            align-items:center; justify-content:center;
            background:rgba(0,0,0,.45); z-index:9999;
        }
        .modal.show{ display:flex; }
        .dialog{
            width:520px; max-width:94vw; background:#232832;
            border-radius:10px; box-shadow:0 16px 40px rgba(0,0,0,.45);
            padding:18px; border:1px solid #3a3f48;
        }
        .dialog.small{ width:360px; }
        .actions{ display:flex; justify-content:flex-end; gap:10px; }
        .actions.center{ justify-content:center; }
        .btn{border:none;border-radius:8px;padding:10px 14px;cursor:pointer;font-weight:600}
        .btn.gray{background:#3b414c;color:#eaeef3}
        .btn.red{background:#e24d4d;color:#fff}

        .chips table{border-collapse:separate;border-spacing:10px 8px}
        .chips input[type="checkbox"]{display:none}
        .chips label{
            display:inline-block;padding:8px 12px;border-radius:999px;
            background:#3a404a;border:1px solid #4a515c;color:#e8eaed;cursor:pointer;
            user-select:none;transition:.15s;
        }
        .chips input[type="checkbox"]:checked + label{
            background:#d0925b;border-color:#d0925b;color:#fff;
            box-shadow:0 0 0 2px rgba(208,146,91,.25);
        }

        table{width:100%;border-collapse:collapse;margin-top:18px}
        th,td{padding:10px 12px;border-bottom:1px solid #40454f}
        th{text-align:left;color:#cfd4dc}

        .item.has-sub .caret{margin-left:auto;transition:transform .15s ease}
        .item.has-sub.open .caret{transform:rotate(180deg)}
        .submenu{list-style:none;margin:6px 0 0 44px;padding:0;display:grid;gap:8px}
        .submenu[hidden]{display:none}
        .submenu a{
            color:#cfd4dc;text-decoration:none;font-style:italic;
            display:inline-block;padding:6px 8px;border-radius:8px
        }
        .submenu a:hover{background:#343b46;color:#fff}
        .item.has-sub.hover .submenu{display:none}
        .item.has-sub.hover:hover .submenu{display:grid}
        .no-click{pointer-events:none}
        #sec-u-mod{--bg:#15181c;--card:#2a2e35;--text:#eef0f3;--muted:#7d8793;--input:#3a3f47;--btn:#d18a5b;--btn2:#b77447;--shadow:0 12px 30px rgba(0,0,0,.45);font-family:Poppins,Arial,Helvetica,sans-serif}
        #sec-u-mod .stage{min-height:calc(100vh - 90px);display:grid;place-items:center;padding:40px 16px}
        #sec-u-mod .card{width:560px;max-width:94vw;background:var(--card);border-radius:12px;box-shadow:var(--shadow);padding:28px 28px 24px;color:var(--text)}
        #sec-u-mod h2{margin:0 0 18px 0;font-size:22px}
        #sec-u-mod .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
        #sec-u-mod .full{grid-column:1/-1}
        #sec-u-mod label{display:block;margin-bottom:6px;font-size:13px;color:#c1c7d0}
        #sec-u-mod .input{width:100%;height:44px;border:none;border-radius:10px;background:var(--input);color:var(--text);padding:0 44px 0 16px;font-size:14px;outline:none}
        #sec-u-mod .fake-caret{position:relative}
        #sec-u-mod .fake-caret::after{content:"";position:absolute;right:14px;top:50%;transform:translateY(-60%);color:#6d7682;font-weight:700}
        #sec-u-mod ::placeholder{color:#6d7682}
        #sec-u-mod .btn{display:inline-block;border:none;border-radius:12px;height:42px;padding:0 22px;background:var(--btn);color:#fff;font-weight:600;cursor:pointer}
        #sec-u-mod .btn:active{transform:translateY(1px);background:var(--btn2)}
        #sec-u-mod .actions{display:flex;justify-content:center;margin-top:16px}
        #sec-u-mod .messages{margin-top:12px;color:#ffbfbf}
        @media (max-width:640px){#sec-u-mod .grid{grid-template-columns:1fr}}
        #mUnidadOk{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:9999}
        #mUnidadOk.show{display:flex}
        #mUnidadOk .dialog{width:360px;max-width:92vw;background:#22262c;color:#eef0f3;border-radius:12px;box-shadow:var(--shadow);padding:20px}
        #mUnidadOk .actions{display:flex;justify-content:center;margin-top:14px}
        #mUnidadOk .btn.gray{background:#3a3f47}
    </style>
</h:head>
<h:body>
    <div class="wrap">
        <div class="shell">
            <div class="header">
                <div class="leftTitle" onclick="toggleDrawer()">
                    <div class="pfp">ðŸ‘¤</div>
                    <span>Administrador</span>
                </div>
                <a class="logout" href="#" onclick="openLogout();return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="1.7">
                        <path d="M10 6H6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h4"/><path d="M15 16l4-4-4-4"/><path d="M19 12H9"/>
                    </svg>
                    <span>Cerrar sesiÃ³n</span>
                </a>
            </div>

            <main id="content" class="content">
                <section id="sec-prof" class="hidden">
                    <div class="form-wrapper">
                        <div class="form-card">
                            <h2>Registrar profesor</h2>
                            <h:form id="profForm">
                                <div class="grid-p">
                                    <div>
                                        <label class="lbl" for="profNombre">Nombre(s)</label>
                                        <h:inputText id="profNombre" value="#{profesorUI.nombre}" maxlength="50" required="true"
                                                     styleClass="input" placeholder="Max: 50 caracteres"/>
                                        <div class="hint warn">Este campo es obligatorio</div>
                                    </div>

                                    <div>
                                        <label class="lbl" for="profApP">Apellido paterno</label>
                                        <h:inputText id="profApP" value="#{profesorUI.apellidoPaterno}" maxlength="50" required="true"
                                                     styleClass="input" placeholder="Max: 50 caracteres"/>
                                        <div class="hint warn">Este campo es obligatorio</div>
                                    </div>

                                    <div>
                                        <label class="lbl" for="profApM">Apellido materno</label>
                                        <h:inputText id="profApM" value="#{profesorUI.apellidoMaterno}" maxlength="50" required="true"
                                                     styleClass="input" placeholder="Max: 50 caracteres"/>
                                        <div class="hint warn">Este campo es obligatorio</div>
                                    </div>

                                    <div>
                                        <label class="lbl" for="profRFC">RFC</label>
                                        <h:inputText id="profRFC" value="#{profesorUI.rfc}" maxlength="13" required="true"
                                                     styleClass="input" placeholder="13 caracteres (persona fÃ­sica)"
                                                     oninput="this.value=this.value.toUpperCase()"/>
                                        <div class="hint">Ejemplo: ABCD001231XYZ</div>
                                    </div>

                                    <div class="span-2">
                                        <label class="lbl" for="profCorreo">Correo institucional</label>
                                        <h:inputText id="profCorreo" value="#{profesorUI.correo}" maxlength="100" required="true"
                                                     styleClass="input" placeholder="ejemplo@uabc.edu.mx"/>
                                        <div class="hint warn">Usa el correo con el que iniciarÃ¡ sesiÃ³n</div>
                                    </div>
                                </div>

                                <div class="center-actions">
                                    <h:commandButton value="Guardar"
                                                     action="#{profesorUI.guardar}"
                                                     styleClass="btn-prim">
                                        <f:ajax execute="@form" render="@form"/>
                                    </h:commandButton>
                                </div>

                                <h:messages globalOnly="true" layout="table" style="color:#ffb3b3;margin-top:14px"/>

                                <h:panelGroup rendered="#{!facesContext.validationFailed and profesorUI.mostrarOk}">
                                    <script>(function(){ openProfOk("#{profesorUI.okMsg}"); })();</script>
                                </h:panelGroup>
                            </h:form>
                        </div>
                    </div>
                </section>

                <div id="mProfOk" class="modal" role="dialog" aria-modal="true"
                     aria-labelledby="profOkTtl" aria-describedby="profOkTxt">
                    <div class="dialog small">
                        <h3 id="profOkTtl" style="margin:0 0 10px 0">Profesor registrado</h3>
                        <p id="profOkTxt" style="margin:0 0 16px 0; color:#cfd4dc">Se guardÃ³ correctamente.</p>
                        <div class="actions center">
                            <button type="button" class="btn gray" onclick="closeProfOk()">Aceptar</button>
                        </div>
                    </div>
                </div>

                <section id="sec-unidades" class="hidden">
                    <div class="form-wrapper">
                        <div class="form-card">
                            <h2>Registrar unidad</h2>
                            <h:form id="fUnidad">
                                <div class="grid-u">
                                    <div class="span-3">
                                        <label class="lbl" for="uNombre">Nombre</label>
                                        <h:inputText id="uNombre" value="#{unidadUI.nombre}" maxlength="50" required="true"
                                                     styleClass="input" placeholder="Max: 50 caracteres"/>
                                        <div class="hint warn">Este campo es obligatorio</div>
                                    </div>

                                    <div>
                                        <label class="lbl" for="uTipo">Tipo</label>
                                        <h:selectOneMenu id="uTipo" value="#{unidadUI.tipo}" styleClass="input" required="true">
                                            <f:selectItem itemLabel="Selecciona..." itemValue=""/>
                                            <f:selectItems value="#{unidadUI.tipos}" />
                                        </h:selectOneMenu>
                                    </div>

                                    <div>
                                        <label class="lbl" for="uHoras">Horas (0â€“4)</label>
                                        <h:inputText id="uHoras" value="#{unidadUI.horas}" required="true"
                                                     styleClass="input" placeholder="(0â€“4)"
                                                     oninput="this.value=this.value.replace(/[^0-4]/g,'')" />
                                    </div>
                                </div>

                                <div class="center-actions">
                                    <h:commandButton value="Guardar"
                                                     action="#{unidadUI.guardar}"
                                                     styleClass="btn-prim">
                                        <f:ajax execute="@form" render="@form" />
                                    </h:commandButton>
                                </div>

                                <h:messages globalOnly="true" layout="table" style="color:#ffb3b3;margin-top:14px"/>

                                <h:panelGroup rendered="#{!facesContext.validationFailed and unidadUI.mostrarOk}">
                                    <script>(function(){ openUnidadOk("#{unidadUI.okMsg}"); })();</script>
                                </h:panelGroup>

                            </h:form>
                        </div>
                    </div>
                </section>

                <section id="sec-u-mod" class="hidden">

                    <div class="stage">
                        <div class="card">
                            <h2>Modificar unidad</h2>
                            <h:form id="fEditUnidad">
                                <div class="grid">
                                    <div class="full">
                                        <label for="uSel">Unidad</label>
                                        <div class="fake-caret">
                                            <h:selectOneMenu id="uSel" value="#{unidadUI.idSeleccionado}" styleClass="input">
                                                <f:selectItem itemLabel="Selecciona..." itemValue="#{null}"/>
                                                <f:selectItems value="#{unidadUI.unidades}" var="u"
                                                               itemValue="#{u.id}"
                                                               itemLabel="#{u.id} - #{u.nombre}"/>
                                                <f:ajax listener="#{unidadUI.onPickUnidad}" render="@form"/>
                                            </h:selectOneMenu>
                                        </div>
                                    </div>

                                    <div class="full">
                                        <label for="eNombre">Nombre de la unidad</label>
                                        <div class="fake-caret">
                                            <h:inputText id="eNombre" value="#{unidadUI.nombre}" styleClass="input"
                                                         maxlength="50" required="true" placeholder="Nombre de la unidad"/>
                                        </div>
                                    </div>

                                    <div>
                                        <label for="eTipo">Tipo</label>
                                        <div class="fake-caret">
                                            <h:selectOneMenu id="eTipo" value="#{unidadUI.tipo}" styleClass="input" required="true">
                                                <f:selectItem itemLabel="Selecciona..." itemValue=""/>
                                                <f:selectItems value="#{unidadUI.tipos}"/>
                                            </h:selectOneMenu>
                                        </div>
                                    </div>

                                    <div>
                                        <label for="eHoras">Horas</label>
                                        <div class="fake-caret">
                                            <h:inputText id="eHoras" value="#{unidadUI.horas}" styleClass="input"
                                                         required="true" placeholder="0-4"
                                                         oninput="this.value=this.value.replace(/[^0-4]/g,'')"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="actions">
                                    <h:commandButton value="Guardar Cambios" action="#{unidadUI.guardarEdicion}" styleClass="btn">
                                        <f:ajax execute="@form" render="@form"/>
                                    </h:commandButton>
                                </div>

                                <h:messages id="msgs" globalOnly="true" styleClass="messages"/>

                                <h:panelGroup rendered="#{!facesContext.validationFailed and unidadUI.mostrarOk}">
                                    <script>(function(){openUnidadOk("#{unidadUI.okMsg}");})();</script>
                                </h:panelGroup>
                            </h:form>
                        </div>
                    </div>

                    <div id="mUnidadOk" role="dialog" aria-modal="true" aria-labelledby="unOkTtl" aria-describedby="unOkTxt">
                        <div class="dialog">
                            <h3 id="unOkTtl" style="margin:0 0 8px 0">Unidad</h3>
                            <p id="unOkTxt" style="margin:0 0 14px 0;color:#cfd4dc">OperaciÃ³n realizada correctamente.</p>
                            <div class="actions">
                                <button type="button" class="btn gray" onclick="closeUnidadOk();if(window.showSecById){showSecById('sec-u-cons');}">Buscar</button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="sec-u-eli" class="hidden">
                    <div class="card"><h3 class="title">Eliminar Unidad</h3><p style="color:#cfd4dc">Plantilla (pendiente de funcionalidad).</p></div>
                </section>
                <section id="sec-u-cons" class="hidden">
                    <div class="card"><h3 class="title">Consultar Unidades</h3><p style="color:#cfd4dc">Plantilla (pendiente de funcionalidad).</p></div>
                </section>

                <section id="sec-asig-crear" class="hidden">
                    <div class="form-wrapper">
                        <div class="form-card">
                            <h2>Crear asignaciÃ³n</h2>
                            <h:form id="fAsig">
                                <div class="grid-u">
                                    <div class="span-3">
                                        <label class="lbl" for="aProf">Selecciona profesor</label>
                                        <h:selectOneMenu id="aProf" value="#{asignacionUI.profesorId}" styleClass="input" required="true">
                                            <f:selectItem itemLabel="Selecciona..." itemValue=""/>
                                            <f:selectItems value="#{asignacionUI.profesores}" var="p"
                                                           itemValue="#{p.id}"
                                                           itemLabel="#{p.nombre} #{p.apellidoPaterno} #{p.apellidoMaterno}"/>
                                        </h:selectOneMenu>
                                        <div class="hint warn">Campo obligatorio</div>
                                    </div>

                                    <div class="span-3">
                                        <label class="lbl" for="aUnis">Selecciona unidades</label>
                                        <h:selectManyListbox id="aUnis" value="#{asignacionUI.unidadIds}" styleClass="input" required="true" size="6">
                                            <f:selectItems value="#{asignacionUI.unidades}" var="u"
                                                           itemValue="#{u.id}"
                                                           itemLabel="#{u.nombre}"/>
                                            <f:converter converterId="jakarta.faces.Integer" />
                                        </h:selectManyListbox>
                                    </div>

                                    <div class="span-3">
                                        <label class="lbl" for="aHorario">Horario</label>
                                        <h:inputText id="aHorario" value="#{asignacionUI.horario}" maxlength="50" required="true"
                                                     styleClass="input" placeholder="Ej. 07:00-08:00 / Matutino"/>
                                        <div class="hint">Formato sugerido: HH:mm + turno</div>
                                    </div>
                                </div>

                                <div class="center-actions">
                                    <h:commandButton value="Buscar"
                                                     action="#{asignacionUI.guardar}"
                                                     styleClass="btn-prim">
                                        <f:ajax execute="@form" render="@form msgs" />
                                    </h:commandButton>
                                </div>

                                <h:messages id="msgs" globalOnly="true" layout="table" style="color:#ffb3b3;margin-top:14px"/>



                                <h:panelGroup rendered="#{!facesContext.validationFailed and asignacionUI.mostrarOk}">
                                    <script>(function(){ openAsigOk("#{asignacionUI.okMsg}"); })();</script>
                                </h:panelGroup>
                            </h:form>
                        </div>
                    </div>
                </section>
                <section id="sec-asig-prof" class="hidden">
                    <div class="card"><h3 class="title">Consultar por Profesor</h3><p style="color:#cfd4dc">Plantilla (pendiente de funcionalidad).</p></div>
                </section>

                <section id="sec-asig" class="hidden">
                    <div class="card"><h3 class="title">Asignaciones</h3><p>â€”</p></div>
                </section>
                <section id="sec-cons" class="hidden">
                    <div class="card"><h3 class="title">Consultas</h3><p>â€”</p></div>
                </section>
            </main>
        </div>
    </div>

    <aside id="drawer" class="drawer" aria-hidden="true">
        <input class="search" placeholder="Buscar"/>

        <ul class="menu">
            <li class="item">
                <a href="#!" onclick="showSecById('sec-prof');return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#eaeef3" stroke-width="1.8"><circle cx="12" cy="8" r="4"/><path d="M6 20a6 6 0 0 1 12 0"/></svg>
                    <span>Profesor</span>
                </a>
            </li>

            <li class="item has-sub hover" id="sub-unidades-root">
                <div class="sub-toggle no-click">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#eaeef3" stroke-width="1.8"><path d="M4 19h16M4 5h16M8 9h8M8 15h8"/></svg>
                    <span>Unidades</span>
                    <span class="caret" aria-hidden="true">â–¾</span>
                </div>
                <ul id="sub-unidades" class="submenu">
                    <li><a href="#!" onclick="showSecById('sec-unidades');return false;">Registrar unidad</a></li>
                    <li><a href="#!" onclick="showSecById('sec-u-mod');return false;">Modificar unidad</a></li>
                    <li><a href="#!" onclick="showSecById('sec-u-eli');return false;">Eliminar unidad</a></li>
                    <li><a href="#!" onclick="showSecById('sec-u-cons');return false;">Consultar unidad</a></li>
                </ul>
            </li>

            <li class="item has-sub hover">
                <div class="sub-toggle no-click">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#eaeef3" stroke-width="1.8"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
                    <span>Asignaciones</span>
                    <span class="caret" aria-hidden="true">â–¾</span>
                </div>
                <ul class="submenu">
                    <li><a href="#!" onclick="showSecById('sec-asig-crear');return false;">Crear AsignaciÃ³n / Asignar Unidad a Profesor</a></li>
                    <li><a href="#!" onclick="showSecById('sec-asig-prof');return false;">Consultar por Profesor</a></li>
                </ul>
            </li>

            <li class="item">
                <a href="#!" onclick="showSecById('sec-cons');return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#eaeef3" stroke-width="1.8"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.3-4.3"/></svg>
                    <span>Consultas</span>
                </a>
            </li>
        </ul>
    </aside>
    <div id="overlay" class="overlay" onclick="toggleDrawer()"></div>

    <div id="mLogout" class="modal" role="dialog" aria-modal="true" aria-labelledby="ttl">
        <div class="dialog">
            <h3 id="ttl">Cerrar sesiÃ³n</h3>
            <p>Â¿Seguro que quieres cerrar sesiÃ³n?</p>
            <div class="actions">
                <button class="btn gray" onclick="closeLogout()">Cancelar</button>
                <h:form style="display:inline">
                    <h:commandButton value="Cerrar sesiÃ³n" actionListener="#{loginUI.logout}" styleClass="btn red"/>
                </h:form>
            </div>
        </div>
    </div>

    <div id="mUnidadOk" class="modal" role="dialog" aria-modal="true"
         aria-labelledby="unOkTtl" aria-describedby="unOkTxt">
        <div class="dialog small">
            <h3 id="unOkTtl" style="margin:0 0 10px 0">Unidad registrada</h3>
            <p id="unOkTxt" style="margin:0 0 16px 0; color:#cfd4dc">Se guardÃ³ correctamente.</p>
            <div class="actions center">
                <button type="button" class="btn gray" id="mOk" onclick="closeUnidadOk()">Aceptar</button>
            </div>
        </div>
    </div>
    <div id="mAsigOk" class="modal" role="dialog" aria-modal="true"
         aria-labelledby="asigOkTtl" aria-describedby="asigOkTxt" style="display:none">
        <div class="dialog small">
            <h3 id="asigOkTtl" style="margin:0 0 10px 0">AsignaciÃ³n guardada</h3>
            <p id="asigOkTxt" style="margin:0 0 16px 0; color:#1f2937">AsignaciÃ³n guardada correctamente.</p>
            <div class="actions center">
                <button type="button" class="btn-sec" onclick="closeAsigOk()">Aceptar</button>
            </div>
        </div>
    </div>
    <div id="mUnidadOk" class="modal" role="dialog" aria-modal="true"
         aria-labelledby="unOkTtl" aria-describedby="unOkTxt">
        <div class="dialog small">
            <h3 id="unOkTtl" style="margin:0 0 10px 0">Unidad</h3>
            <p id="unOkTxt" style="margin:0 0 16px 0; color:#cfd4dc">OperaciÃ³n realizada correctamente.</p>
            <div class="actions center">
                <button type="button" class="btn gray" onclick="closeUnidadOk();showSecById('sec-u-cons')">Buscar</button>
            </div>
        </div>
    </div>


    <script>
        function toggleDrawer(){
            const d = document.getElementById('drawer');
            const o = document.getElementById('overlay');
            const open = !d.classList.contains('open');
            d.classList.toggle('open', open);
            o.classList.toggle('show', open);
            d.setAttribute('aria-hidden', open ? 'false':'true');
        }
        function showSec(el){
            document.querySelectorAll('#drawer .item > a').forEach(i=>i.parentElement.classList.remove('active'));
            el.parentElement?.classList?.add('active');
            const id = el.getAttribute('data-target');
            document.querySelectorAll('#content > section').forEach(s=>s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            toggleDrawer();
        }
        function showSecById(id){
            document.querySelectorAll('#content > section').forEach(s=>s.classList.add('hidden'));
            const sec = document.getElementById(id);
            if (sec) sec.classList.remove('hidden');
            window.scrollTo({top: 0, behavior: 'smooth'});
        }
        function toggleSub(rootId, listId){
            const root = document.getElementById(rootId);
            const list = document.getElementById(listId);
            const btn  = root?.querySelector('.sub-toggle');
            const expanded = btn?.getAttribute('aria-expanded') === 'true';
            btn?.setAttribute('aria-expanded', (!expanded).toString());
            if (!expanded){ list?.removeAttribute('hidden'); root?.classList.add('open'); }
            else { list?.setAttribute('hidden',''); root?.classList.remove('open'); }
        }

        function openLogout(){ document.getElementById('mLogout').classList.add('show'); }
        function closeLogout(){ document.getElementById('mLogout').classList.remove('show'); }

        function openUnidadOk(texto){
            const m = document.getElementById('mUnidadOk');
            const t = document.getElementById('unOkTxt');
            if (t) t.textContent = texto || 'Unidad registrada correctamente.';
            if (m) m.classList.add('show');
        }
        function closeUnidadOk(){
            const m = document.getElementById('mUnidadOk');
            if (m) m.classList.remove('show');
        }

        function openProfOk(texto){
            const m = document.getElementById('mProfOk');
            const t = document.getElementById('profOkTxt');
            if (t) t.textContent = texto || 'Profesor registrado correctamente.';
            if (m) m.classList.add('show');
        }
        function closeProfOk(){
            const m = document.getElementById('mProfOk');
            if (m) m.classList.remove('show');
        }
        function openAsigOk(texto){
            const m=document.getElementById('mAsigOk');
            const t=document.getElementById('asigOkTxt');
            if(t) t.textContent = texto || 'AsignaciÃ³n guardada correctamente.';
            if(m){ m.style.display='flex'; m.classList.add('show'); }
        }
        function closeAsigOk(){
            const m=document.getElementById('mAsigOk');
            if(m){ m.classList.remove('show'); m.style.display='none'; }
        }

        window.addEventListener('pageshow', function (e) {
            if (e.persisted || (performance.getEntriesByType('navigation')[0]?.type === 'back_forward')) {
                window.location.reload();
            }
        });
    </script>
</h:body>
</html>
